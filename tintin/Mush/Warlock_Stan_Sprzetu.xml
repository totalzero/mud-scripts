<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE muclient>
<!-- "Warlock_Stan_Sprzetu" -->

<muclient>
<plugin
   name="Warlock_Stan_Sprzetu"
   author="Mercer"
   id="f25c9458ed184cb7a27f3dd4"
   language="Lua"
   date_written="2013-02-18 23:51:37"
   requires="3.42"
   version="1.0"
   >
</plugin>

<!--  Triggers  -->

<triggers>
 <trigger
   enabled="n"
   group="ocena_zbroi"
   match="^Oceniasz, ze (.*) (wazy|waza) (.*), zas (jego|jej|ich) objetosc wynosi (.*)\.$"
   regexp="y"
   script="Wykryj_Nazwe_Zbroi"
   sequence="1"
 >
 </trigger>
 <trigger
   enabled="n"
   group="ocena_zbroi"
   match="^Wyglada na to, ze (jest|sa) (.*) i (.*)\.$"
   regexp="y"
   script="Wykryj_Stan_Zbroi"
   sequence="1"
 >
 </trigger>
 <trigger
   enabled="n"
   group="ocena_zbroi"
   match="^Wyglada na to, ze (jest|sa) (.*)\.$"
   regexp="y"
   script="Wykryj_Stan_Zbroi"
   sequence="1"
 >
 </trigger>
 <trigger
   enabled="n"
   group="ocena_zbroi"
   match="^Wyglada na to, ze (moglby|moglaby|moglyby) ci jeszcze (.*)\.$"
   regexp="y"
   script="Wykryj_Zywotnosc_Zbroi"
   sequence="1"
 >
 </trigger>
 <trigger
   enabled="n"
   group="ocena_zbroi"
   match="^Jest to (.*) i zaklada sie na (.*)\.$"
   regexp="y"
   script="Dodaj_Zbroje"
   sequence="1"
 >
 </trigger>
 <trigger
   enabled="n"
   name="straznik_oceny"
   match="^\(SKRYPT\: KONIEC OCENY SPRZETU\)$"
   regexp="y"
   script="Skoncz_Ocene"
   sequence="1"
   custom_colour="17"
   other_text_colour="crimson"
 >
 </trigger>
</triggers>

<!--  Aliases  -->

<aliases>
  <alias
   match="oss"
   enabled="y"
   script="Rozpocznij_Ocene"
   sequence="10"
  >
  </alias>
  <alias
   match="wss"
   enabled="y"
   script="Wyswietl_Stan_Sprzetu"
   sequence="10"
  >
  </alias>
  <alias
   match="stan_sprzetu_help"
   enabled="y"
   script="Stan_Sprzetu_Instrukcja"
   sequence="10"
  >
  </alias>
</aliases>

<!--  Variables  -->

<variables>
  <variable name="zm_nazwa_zbroi">brak_nazwy</variable>
  <variable name="zm_stan_zbroi">brak_stanu</variable>
  <variable name="zm_zywotnosc_zbroi">brak_zywotnosci</variable>
  <variable name="zm_numer_zbroi">1</variable>
</variables>

<!--  Script  -->

<script>
<![CDATA[

function OnPluginConnect()
  EnablePlugin("7ed284fed564c8762b159f8d", false)
  EnableTriggerGroup("ocena_zbroi", false)
  EnableTrigger("straznik_oceny", false)
end

function Zacznij_Od_Duzej(str)
  return (str:gsub("^%l", string.upper))
end

function Rozpocznij_Ocene()
  if GetVariable("zm_nazwa_zbroi") ~= "brak_nazwy" or GetVariable("zm_stan_zbroi") ~= "brak_stanu" or GetVariable("zm_zywotnosc_zbroi") ~= "brak_zywotnosci" or GetVariable("zm_numer_zbroi") ~= "1" then
    for i = 1, GetVariable("zm_numer_zbroi") do
      DeleteVariable("zm_zbroja_"..i)
    end
    SetVariable("zm_nazwa_zbroi", "brak_nazwy")
    SetVariable("zm_stan_zbroi", "brak_stanu")
    SetVariable("zm_zywotnosc_zbroi", "brak_zywotnosci")
    SetVariable("zm_numer_zbroi", "1")
  end
  EnableTriggerGroup("ocena_zbroi", true)
  EnableTrigger("straznik_oceny", true)
  EnablePlugin("7ed284fed564c8762b159f8d", true)
  Send("ocen wszystkie zbroje")
end

function Wykryj_Nazwe_Zbroi(a, b, c)
  SetVariable("zm_nazwa_zbroi", c[1])
end

function Wykryj_Stan_Zbroi(a, b, c)
  SetVariable("zm_stan_zbroi", c[1].." "..c[2])
end

function Wykryj_Zywotnosc_Zbroi(a, b, c)
  SetVariable("zm_zywotnosc_zbroi", c[1].." ci jeszcze "..c[2])
end

function Dodaj_Zbroje(a, b, c)
  if GetVariable("zm_nazwa_zbroi") ~= "brak_nazwy" and GetVariable("zm_stan_zbroi") ~= "brak_stanu" and GetVariable("zm_zywotnosc_zbroi") ~= "brak_zywotnosci" then
    SetVariable("zm_zbroja_"..GetVariable("zm_numer_zbroi"), "["..string.upper(c[2]).."] "..Zacznij_Od_Duzej(GetVariable("zm_nazwa_zbroi")).." "..GetVariable("zm_stan_zbroi").." i "..GetVariable("zm_zywotnosc_zbroi")..".")
    SetVariable("zm_nazwa_zbroi", "brak_nazwy")
    SetVariable("zm_stan_zbroi", "brak_stanu")
    SetVariable("zm_zywotnosc_zbroi", "brak_zywotnosci")
    SetVariable("zm_numer_zbroi", GetVariable("zm_numer_zbroi")+1)
  elseif GetVariable("zm_nazwa_zbroi") ~= "brak_nazwy" and GetVariable("zm_stan_zbroi") ~= "brak_stanu" and GetVariable("zm_zywotnosc_zbroi") == "brak_zywotnosci" then
    SetVariable("zm_zbroja_"..GetVariable("zm_numer_zbroi"), "["..string.upper(c[2]).."] "..Zacznij_Od_Duzej(GetVariable("zm_nazwa_zbroi")).." "..GetVariable("zm_stan_zbroi")..". <KONIEC CZASU>")
    SetVariable("zm_nazwa_zbroi", "brak_nazwy")
    SetVariable("zm_stan_zbroi", "brak_stanu")
    SetVariable("zm_zywotnosc_zbroi", "brak_zywotnosci")
    SetVariable("zm_numer_zbroi", GetVariable("zm_numer_zbroi")+1)
  end
end

function Skoncz_Ocene()
  EnablePlugin("7ed284fed564c8762b159f8d", false)
  EnableTriggerGroup("ocena_zbroi", false)
  EnableTrigger("straznik_oceny", false)
  ColourTell("green", "black", "Ocena sprzetu zostala zakonczona. Wpisz")
  ColourTell("crimson", "black", " \"wss\"")
  ColourNote("green", "black", ", aby wyswietlic rezultaty.")
end

function Wyswietl_Stan_Sprzetu()
  if GetVariable("zm_numer_zbroi") ~= "1" then
    Note("")
    ColourNote("crimson", "black", "Stan sprzetu:")
    Note("")
    for i = 1, GetVariable("zm_numer_zbroi") do
      if GetVariable("zm_zbroja_"..i) ~= nil then 
        ColourTell("crimson", "black", i..")")
        ColourNote("green", "black", " "..GetVariable("zm_zbroja_"..i))
      end
    end
  else
    ColourTell("green", "black", "Brak rezultatow. Uzyj komendy")
    ColourTell("crimson", "black", " \"oss\"")
    ColourNote("green", "black", ", aby ocenic stan sprzetu.")
  end
end

function Stan_Sprzetu_Instrukcja()
  Note("")
  ColourNote("crimson", "black", "Instrukcja:")
  Note("")
  ColourTell("green", "black", "Alias")
  ColourTell("crimson", "black", " \"oss\" ")
  ColourNote("green", "black", "rozpoczyna ocene sprzetu.")
  Note("")
  ColourTell("green", "black", "Alias")
  ColourTell("crimson", "black", " \"wss\" ")
  ColourNote("green", "black", "wyswietla stan ocenionego sprzetu.")
end

]]>
</script>

</muclient>